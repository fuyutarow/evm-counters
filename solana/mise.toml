[tools]
node = "24.8.0"
rust = "1.89.0"

[env]
_.path = ["~/.local/share/solana/install/active_release/bin"]
SOLANA_HOME = "~/.local/share/solana/install/active_release"
RUSTFLAGS = "-A unexpected_cfgs -A deprecated"

[vars]
default_network = "localnet"
gas_budget = "100000000"

# ===============================================
# ğŸš€ ä¸»è¦ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆã‚ˆãä½¿ã†ã‚¿ã‚¹ã‚¯ï¼‰
# ===============================================

[tasks.dev]
description = "é–‹ç™ºç’°å¢ƒã®å®Œå…¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—"
alias = "d"
depends = ["localnode:start", "localnode:wait", "wallet:setup", "deploy", "ui:dev"]

[tasks.build]
description = "å…¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ“ãƒ«ãƒ‰"
alias = "b"
depends = ["build:programs"]

[tasks.deploy]
description = "å…¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ‡ãƒ—ãƒ­ã‚¤"
depends = ["build", "keypairs", "deploy:programs"]

[tasks.test]
description = "ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ"
alias = "t"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ§ª ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆä¸­..."
anchor build --no-idl
echo "âœ… ãƒ“ãƒ«ãƒ‰æˆåŠŸï¼ˆãƒ†ã‚¹ãƒˆæœªå®Ÿè£…ï¼‰"
'''

[tasks.clean]
description = "å…¨ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"
alias = "c"
depends = ["clean:target", "clean:ledger"]

[tasks.install]
description = "å…¨ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
alias = "i"
depends = ["ui:install", "install:solana", "install:anchor"]

[tasks."install-cli"]
description = "Solana & Anchor CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
alias = "ic"
depends = ["install:solana", "install:anchor"]

[tasks.up]
description = "ä¾å­˜é–¢ä¿‚ã‚’æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æ›´æ–°"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ“¦ å¤ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒã‚§ãƒƒã‚¯ä¸­..."
bun outdated
echo ""
echo "ğŸ“¦ package.jsonã‚’æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æ›´æ–°ä¸­..."
bunx npm-check-updates -u
echo ""
echo "ğŸ“¦ æ›´æ–°ã•ã‚ŒãŸä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
bun install
echo "âœ… ä¾å­˜é–¢ä¿‚ã‚’æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æ›´æ–°å®Œäº†ï¼"
'''

# ===============================================
# ğŸ“‹ ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»ç®¡ç†ã‚¿ã‚¹ã‚¯
# ===============================================

[tasks.status]
description = "é–‹ç™ºç’°å¢ƒã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º"
alias = "s"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ“‹ é–‹ç™ºç’°å¢ƒã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"
echo "=================================="
echo ""
echo "ğŸ”§ ãƒ„ãƒ¼ãƒ«:"
solana --version 2>/dev/null || echo "âŒ Solana æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
anchor --version 2>/dev/null || echo "âŒ Anchor æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
echo ""
echo "ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯:"
solana config get | grep 'RPC URL' | awk '{print "   RPC URL:", $3}' 2>/dev/null || echo "âŒ Solanaè¨­å®šæœªå®Œäº†"
echo ""
echo "ğŸ’° ã‚¦ã‚©ãƒ¬ãƒƒãƒˆ:"
solana address 2>/dev/null | awk '{print "   ã‚¢ãƒ‰ãƒ¬ã‚¹:", $1}' || echo "âŒ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæœªè¨­å®š"
solana balance 2>/dev/null | awk '{print "   æ®‹é«˜:", $1, $2}' || echo "âŒ æ®‹é«˜æƒ…å ±ãªã—"
echo ""
echo "ğŸš€ ãƒãƒªãƒ‡ãƒ¼ã‚¿:"
if solana cluster-version > /dev/null 2>&1; then
    echo "   ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: âœ… èµ·å‹•ä¸­"
    solana cluster-version | head -1 | awk '{print "   ãƒãƒ¼ã‚¸ãƒ§ãƒ³:", $1, $2}'
else
    echo "   ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: âŒ åœæ­¢ä¸­"
fi
echo ""
echo "ğŸ“¦ ãƒ—ãƒ­ã‚°ãƒ©ãƒ :"
if [ -f "target/deploy/owned_counter-keypair.json" ]; then
    echo "   owned_counter: $(solana address -k target/deploy/owned_counter-keypair.json)"
else
    echo "   owned_counter: âŒ æœªãƒ‡ãƒ—ãƒ­ã‚¤"
fi
if [ -f "target/deploy/shared_counter-keypair.json" ]; then
    echo "   shared_counter: $(solana address -k target/deploy/shared_counter-keypair.json)"
else
    echo "   shared_counter: âŒ æœªãƒ‡ãƒ—ãƒ­ã‚¤"
fi
'''

[tasks.lint]
description = "å…¨ãƒªãƒ³ã‚¿ãƒ¼ã®å®Ÿè¡Œ"
alias = "l"
depends = ["lint:biome", "lint:typescript", "lint:rust"]

[tasks.fix]
description = "è‡ªå‹•ä¿®æ­£å¯èƒ½ãªå•é¡Œã®ä¿®æ­£"
alias = "f"
depends = ["fix:biome", "fix:rust"]

[tasks.logs]
description = "ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ­ã‚°ã®è¡¨ç¤º"
run = "solana logs"

# ===============================================
# ğŸ¯ ãã®ä»–ã®ã‚³ãƒ³ãƒã‚¸ãƒƒãƒˆã‚¿ã‚¹ã‚¯
# ===============================================

[tasks."dev:backend"]
description = "ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿ï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚¿ + ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰"
depends = ["localnode:start", "localnode:wait", "wallet:setup", "deploy"]

[tasks."dev:full"]
description = "ãƒ•ãƒ«é–‹ç™ºã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆã‚¼ãƒ­ã‹ã‚‰ï¼‰"
depends = ["install", "dev"]

[tasks."wallet:setup"]
description = "ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®å®Œå…¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—"
depends = ["wallet:create", "wallet:configure", "wallet:airdrop"]

[tasks.keypairs]
description = "å…¨éµãƒšã‚¢ã®ç”Ÿæˆ"
depends = ["keypair:owned", "keypair:shared"]

[tasks.idl]
description = "å…¨IDLãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆ"
depends = ["idl:owned", "idl:shared"]

# ===============================================
# ğŸ—ï¸  ã‚¢ãƒˆãƒŸãƒƒã‚¯ ã‚¤ãƒ³ãƒ•ãƒ©ã‚¿ã‚¹ã‚¯ï¼ˆå®Ÿè£…è©³ç´°ï¼‰
# ===============================================

[tasks."localnode:start"]
description = "ãƒ­ãƒ¼ã‚«ãƒ«Solanaãƒãƒªãƒ‡ãƒ¼ã‚¿ã®èµ·å‹•"
alias = "vs"
run = '''
#!/usr/bin/env bash
set -euo pipefail
if ! command -v solana-test-validator >/dev/null 2>&1; then
    echo "âŒ solana-test-validator ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚'mise run install:solana' ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"
    exit 1
fi

# æ—¢ã«èµ·å‹•ä¸­ã‹ãƒã‚§ãƒƒã‚¯
if solana cluster-version > /dev/null 2>&1; then
    echo "âœ… ãƒãƒªãƒ‡ãƒ¼ã‚¿ã¯æ—¢ã«èµ·å‹•ä¸­"
    exit 0
fi

echo "ğŸš€ ãƒãƒªãƒ‡ãƒ¼ã‚¿èµ·å‹•ä¸­..."
solana-test-validator --reset &
'''

[tasks."localnode:stop"]
description = "ãƒ­ãƒ¼ã‚«ãƒ«Solanaãƒãƒªãƒ‡ãƒ¼ã‚¿ã®åœæ­¢"
alias = "vx"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ›‘ ãƒãƒªãƒ‡ãƒ¼ã‚¿åœæ­¢ä¸­..."
pkill -f solana-test-validator || echo "ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ã‚»ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
'''

[tasks."localnode:status"]
description = "ãƒãƒªãƒ‡ãƒ¼ã‚¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ç¢ºèª"
run = '''
#!/usr/bin/env bash
set -euo pipefail
if solana cluster-version > /dev/null 2>&1; then
    echo "âœ… ãƒãƒªãƒ‡ãƒ¼ã‚¿èµ·å‹•ä¸­"
    echo "ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³: $(solana cluster-version)"
else
    echo "âŒ ãƒãƒªãƒ‡ãƒ¼ã‚¿åœæ­¢ä¸­"
    exit 1
fi
'''

[tasks."localnode:wait"]
description = "ãƒãƒªãƒ‡ãƒ¼ã‚¿ã®èµ·å‹•å®Œäº†ã‚’å¾…æ©Ÿ"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "â³ ãƒãƒªãƒ‡ãƒ¼ã‚¿ã®èµ·å‹•å®Œäº†ã‚’å¾…æ©Ÿä¸­..."
for i in {1..30}; do
    if solana cluster-version > /dev/null 2>&1; then
        echo "âœ… ãƒãƒªãƒ‡ãƒ¼ã‚¿èµ·å‹•å®Œäº†!"
        exit 0
    fi
    echo -n "."
    sleep 1
done
echo ""
echo "âŒ ãƒãƒªãƒ‡ãƒ¼ã‚¿ãŒ30ç§’ä»¥å†…ã«èµ·å‹•ã—ã¾ã›ã‚“ã§ã—ãŸ"
exit 1
'''

# ===============================================
# ğŸ’° ã‚¢ãƒˆãƒŸãƒƒã‚¯ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¿ã‚¹ã‚¯
# ===============================================

[tasks."wallet:create"]
description = "é–‹ç™ºç”¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ä½œæˆ"
run = '''
#!/usr/bin/env bash
set -euo pipefail
mkdir -p ~/.config/solana
if [ -f ~/.config/solana/id.json ]; then
    echo "âœ… ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ—¢å­˜: $(solana address)"
else
    echo "ğŸ”‘ æ–°ã—ã„ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆä¸­..."
    solana-keygen new --no-bip39-passphrase --silent --force --outfile ~/.config/solana/id.json
    echo "âœ… ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆå®Œäº†: $(solana address)"
fi
'''

[tasks."wallet:configure"]
description = "ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®è¨­å®š"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "âš™ï¸ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆè¨­å®šä¸­..."
solana config set --url localhost
solana config set --keypair ~/.config/solana/id.json
echo "âœ… localhostç”¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆè¨­å®šå®Œäº†"
'''

[tasks."wallet:airdrop"]
description = "SOLã‚¨ã‚¢ãƒ‰ãƒ­ãƒƒãƒ—ã®è¦æ±‚"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ’° ã‚¨ã‚¢ãƒ‰ãƒ­ãƒƒãƒ—è¦æ±‚ä¸­..."
solana airdrop 2
echo "ğŸ’° è¿½åŠ ã‚¨ã‚¢ãƒ‰ãƒ­ãƒƒãƒ—è¦æ±‚ä¸­..."
solana airdrop 2
echo "âœ… æ®‹é«˜: $(solana balance)"
'''

[tasks."wallet:balance"]
description = "ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ®‹é«˜ã®è¡¨ç¤º"
alias = "balance"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ’° ã‚¦ã‚©ãƒ¬ãƒƒãƒˆ: $(solana address)"
echo "ğŸ’° æ®‹é«˜: $(solana balance)"
echo "ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯: $(solana config get | grep 'RPC URL' | awk '{print $3}')"
'''

# ===============================================
# ğŸ”¨ ã‚¢ãƒˆãƒŸãƒƒã‚¯ ãƒ“ãƒ«ãƒ‰ã‚¿ã‚¹ã‚¯
# ===============================================

[tasks."build:programs"]
description = "å…¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ“ãƒ«ãƒ‰"
run = '''
#!/usr/bin/env bash
set -euo pipefail
mkdir -p target/deploy
echo "ğŸ”¨ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ“ãƒ«ãƒ‰ä¸­..."
echo "  owned_counter..."
cargo build-sbf --manifest-path programs/owned_counter/Cargo.toml --sbf-out-dir target/deploy
echo "  shared_counter..."
cargo build-sbf --manifest-path programs/shared_counter/Cargo.toml --sbf-out-dir target/deploy

if [ -f "target/deploy/owned_counter.so" ] && [ -f "target/deploy/shared_counter.so" ]; then
    echo "âœ… å…¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ“ãƒ«ãƒ‰å®Œäº†:"
    echo "   owned_counter.so ($(stat -c%s target/deploy/owned_counter.so) bytes)"
    echo "   shared_counter.so ($(stat -c%s target/deploy/shared_counter.so) bytes)"
else
    echo "âŒ ä¸€éƒ¨ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã—ã¾ã—ãŸ"
    ls -la target/deploy/*.so 2>/dev/null || echo "  ãƒ“ãƒ«ãƒ‰æˆæœç‰©ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
    exit 1
fi
'''

[tasks."idl:owned"]
description = "owned_counter IDLã®ã¿ç”Ÿæˆ"
run = '''
#!/usr/bin/env bash
set -euo pipefail
mkdir -p src/idl
echo "ğŸ“„ owned_counter IDLç”Ÿæˆä¸­..."
if anchor idl build -p owned_counter -o src/idl/owned_counter.json -t src/idl/owned_counter.ts --no-docs 2>/dev/null; then
    echo "âœ… owned_counter IDLç”Ÿæˆå®Œäº†"
else
    echo "âŒ owned_counter IDLç”Ÿæˆå¤±æ•—"
    exit 1
fi
'''

[tasks."idl:shared"]
description = "shared_counter IDLã®ã¿ç”Ÿæˆ"
run = '''
#!/usr/bin/env bash
set -euo pipefail
mkdir -p src/idl
echo "ğŸ“„ shared_counter IDLç”Ÿæˆä¸­..."
if anchor idl build -p shared_counter -o src/idl/shared_counter.json -t src/idl/shared_counter.ts --no-docs 2>/dev/null; then
    echo "âœ… shared_counter IDLç”Ÿæˆå®Œäº†"
else
    echo "âŒ shared_counter IDLç”Ÿæˆå¤±æ•—"
    exit 1
fi
'''

# ===============================================
# ğŸ”‘ ã‚¢ãƒˆãƒŸãƒƒã‚¯ éµãƒšã‚¢ã‚¿ã‚¹ã‚¯
# ===============================================

[tasks."keypair:owned"]
description = "owned_counteréµãƒšã‚¢ã®ã¿ç”Ÿæˆ"
run = '''
#!/usr/bin/env bash
set -euo pipefail
mkdir -p target/deploy
if [ -f "target/deploy/owned_counter-keypair.json" ]; then
    echo "âœ… owned_counteréµãƒšã‚¢æ—¢å­˜: $(solana address -k target/deploy/owned_counter-keypair.json)"
else
    echo "ğŸ”‘ owned_counteréµãƒšã‚¢ç”Ÿæˆä¸­..."
    solana-keygen new -o target/deploy/owned_counter-keypair.json --no-bip39-passphrase --force --silent
    echo "âœ… owned_counteréµãƒšã‚¢: $(solana address -k target/deploy/owned_counter-keypair.json)"
fi
'''

[tasks."keypair:shared"]
description = "shared_counteréµãƒšã‚¢ã®ã¿ç”Ÿæˆ"
run = '''
#!/usr/bin/env bash
set -euo pipefail
mkdir -p target/deploy
if [ -f "target/deploy/shared_counter-keypair.json" ]; then
    echo "âœ… shared_counteréµãƒšã‚¢æ—¢å­˜: $(solana address -k target/deploy/shared_counter-keypair.json)"
else
    echo "ğŸ”‘ shared_counteréµãƒšã‚¢ç”Ÿæˆä¸­..."
    solana-keygen new -o target/deploy/shared_counter-keypair.json --no-bip39-passphrase --force --silent
    echo "âœ… shared_counteréµãƒšã‚¢: $(solana address -k target/deploy/shared_counter-keypair.json)"
fi
'''

# ===============================================
# ğŸš€ ã‚¢ãƒˆãƒŸãƒƒã‚¯ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¿ã‚¹ã‚¯
# ===============================================

[tasks."deploy:programs"]
description = "å…¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ‡ãƒ—ãƒ­ã‚¤"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸš€ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­..."

# å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯
if [ ! -f "target/deploy/owned_counter.so" ] || [ ! -f "target/deploy/shared_counter.so" ]; then
    echo "âŒ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚'mise run build:programs' ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"
    exit 1
fi
if [ ! -f "target/deploy/owned_counter-keypair.json" ] || [ ! -f "target/deploy/shared_counter-keypair.json" ]; then
    echo "âŒ éµãƒšã‚¢ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚'mise run keypairs' ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"
    exit 1
fi

echo "  owned_counter ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­..."
solana program deploy target/deploy/owned_counter.so \
  --program-id target/deploy/owned_counter-keypair.json

echo "  shared_counter ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­..."
solana program deploy target/deploy/shared_counter.so \
  --program-id target/deploy/shared_counter-keypair.json

echo "âœ… å…¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†:"
echo "   owned_counter: $(solana address -k target/deploy/owned_counter-keypair.json)"
echo "   shared_counter: $(solana address -k target/deploy/shared_counter-keypair.json)"
'''

# ===============================================
# ğŸŒ ã‚¢ãƒˆãƒŸãƒƒã‚¯ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯
# ===============================================

[tasks."ui:install"]
description = "UIä¾å­˜é–¢ä¿‚ã®ã¿ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ“¦ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
bun install
echo "âœ… ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†"
'''

[tasks."ui:dev"]
description = "UIé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®ã¿èµ·å‹•"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸŒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ä¸­..."
bun run dev
'''

[tasks."ui:build"]
description = "UIã®ã¿ãƒ“ãƒ«ãƒ‰"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ—ï¸ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰ä¸­..."
bun run build
echo "âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰å®Œäº†"
'''

[tasks."ui:typecheck"]
description = "TypeScriptå‹ãƒã‚§ãƒƒã‚¯ã®ã¿"
alias = "typecheck"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ” å‹ãƒã‚§ãƒƒã‚¯ä¸­..."
bun tsc --noEmit
echo "âœ… å‹ãƒã‚§ãƒƒã‚¯å®Œäº†"
'''

# ===============================================
# ğŸ§¹ ã‚¢ãƒˆãƒŸãƒƒã‚¯ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¿ã‚¹ã‚¯
# ===============================================

[tasks."clean:target"]
description = "targetãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã¿ã‚¯ãƒªãƒ¼ãƒ³"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ§¹ targetãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚¯ãƒªãƒ¼ãƒ³ä¸­..."
rm -rf target/ || true
echo "âœ… targetã‚¯ãƒªãƒ¼ãƒ³å®Œäº†"
'''

[tasks."clean:ledger"]
description = "ãƒãƒªãƒ‡ãƒ¼ã‚¿å°å¸³ã®ã¿ã‚¯ãƒªãƒ¼ãƒ³"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ§¹ ãƒãƒªãƒ‡ãƒ¼ã‚¿å°å¸³ã‚¯ãƒªãƒ¼ãƒ³ä¸­..."
rm -rf test-ledger/ || true
echo "âœ… å°å¸³ã‚¯ãƒªãƒ¼ãƒ³å®Œäº†"
'''

# ===============================================
# ğŸ“¦ ã‚¢ãƒˆãƒŸãƒƒã‚¯ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯
# ===============================================

[tasks."install:solana"]
description = "Solanaãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ã®ã¿ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
run = '''
#!/usr/bin/env bash
set -euo pipefail
if ! command -v solana-test-validator >/dev/null 2>&1; then
    echo "ğŸ“¦ Solana/Agave ãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ v3.0.2 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
    sh -c "$(curl -sSfL https://release.anza.xyz/v3.0.2/install)"
    echo "âœ… Solana ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†: $(~/.local/share/solana/install/active_release/bin/solana --version)"
else
    echo "âœ… Solana æ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿: $(solana-test-validator --version | head -1)"
fi
'''

[tasks."install:anchor"]
description = "Anchorãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ã®ã¿ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
run = '''
#!/usr/bin/env bash
set -euo pipefail
if ! command -v avm >/dev/null 2>&1; then
    echo "ğŸ“¦ Anchor AVM ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
    cargo install --git https://github.com/coral-xyz/anchor avm --locked --force
fi
echo "ğŸ“¦ Anchor v0.31.1 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
avm install 0.31.1
avm use 0.31.1
echo "âœ… Anchor æº–å‚™å®Œäº†: $(anchor --version)"
'''

# ===============================================
# ğŸ” ã‚¢ãƒˆãƒŸãƒƒã‚¯ ãƒªãƒ³ãƒˆãƒ»ä¿®æ­£ã‚¿ã‚¹ã‚¯
# ===============================================

[tasks."lint:biome"]
description = "Biomeãƒã‚§ãƒƒã‚¯ã®ã¿"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ” Biomeãƒã‚§ãƒƒã‚¯ä¸­..."
bun biome check .
echo "âœ… Biomeãƒã‚§ãƒƒã‚¯å®Œäº†"
'''

[tasks."lint:typescript"]
description = "TypeScriptå‹ãƒã‚§ãƒƒã‚¯ã®ã¿"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ” TypeScriptå‹ãƒã‚§ãƒƒã‚¯ä¸­..."
bun tsc --noEmit
echo "âœ… TypeScriptå‹ãƒã‚§ãƒƒã‚¯å®Œäº†"
'''

[tasks."lint:rust"]
description = "Rustãƒã‚§ãƒƒã‚¯ã®ã¿"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ” Rustãƒã‚§ãƒƒã‚¯ä¸­..."
echo "  owned_counter..."
cargo check --manifest-path programs/owned_counter/Cargo.toml
echo "  shared_counter..."
cargo check --manifest-path programs/shared_counter/Cargo.toml
echo "âœ… Rustãƒã‚§ãƒƒã‚¯å®Œäº†"
'''

[tasks."fix:biome"]
description = "Biomeè‡ªå‹•ä¿®æ­£ã®ã¿"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ”§ Biomeè‡ªå‹•ä¿®æ­£ä¸­..."
bun biome check --write --unsafe .
echo "âœ… Biomeä¿®æ­£å®Œäº†"
'''

[tasks."fix:rust"]
description = "Rustãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ã¿"
run = '''
#!/usr/bin/env bash
set -euo pipefail
echo "ğŸ”§ Rustãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¸­..."
echo "  owned_counter..."
cargo fmt --manifest-path programs/owned_counter/Cargo.toml
echo "  shared_counter..."
cargo fmt --manifest-path programs/shared_counter/Cargo.toml
echo "âœ… Rustãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®Œäº†"
'''